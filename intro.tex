\chapter{绪论}
\label{chap:intro}

\section{研究背景}

3D人脸重建是计算机视觉和计算机图形学领域的一个热门研究方向。
相比于传统计算机视觉对2D照片的判断、识别和生成，3D的人脸表示更加贴近实际，并可以建模光照和视角产生的影响。
例如，3D人脸模型可显式地表达人脸在3D空间中的位置，姿态甚至表情和骨骼的位置；
高质量的模型可用于逼真地一致地渲染出不同环境和视角下的人脸图像。

3D人脸模型带来的优势是以更复杂的成像过程为代价的，这通常会限制其范围。
3D人脸信息通常使用立体视觉系统\citep{DEP,ss_geo}、3D激光扫描仪（例如NextEngine和Cyberware）或RGB-D相机（如Kinect）进行捕获。
前两种捕获高质量的人脸扫描，但需要受控环境和昂贵的机器。
相比之下，RGB-D相机更便宜，更易于使用，但所得到的扫描质量有限。

相比之下，能从普通非受限环境的照片或视频中重建3D人脸模型的高效重建方法受到了广泛关注。
这类方法只需要最少单张手机随意拍摄的照片即可实时完成3D重建。
它结合了2D图像拍摄的便捷性和3D人脸模型的优势，
其应用非常广泛，目前已被用于人脸识别\citep{BlanzV03,1022631413.nh,zhu2015high}、人脸表情捕捉\cite{Mo2022TowardsAF}、人脸跟踪\citep{Pham2016RobustRP}、人脸动画合成\citep{Cao20133DSR,thies2016face2face}等任务中。

然而，该任务如今依然非常具有挑战性。
从少量非受限环境中拍摄的照片重建3D模型是高度不适定的。
算法需要从单张照片中估计出人脸几何形状、头部姿势和纹理、环境光照等参数，这个问题是欠定的。
因此，从照片重建3D人脸模型的解之间存在歧义，因为同一张照片可以从不同的3D人脸模型中生成，
并且很难确定哪个模型才更加准确。

基于人脸3D可形变模型（3D Morphable Model，简称3DMM）和神经网络的方法能以数据驱动的方式更好地建模有关人脸的先验知识。
3DMM是从大量人脸3D扫描中得到的统计模型，其先验知识通常编码于均值、方差等统计量中；
而神经网络则能从各种各样的监督信号中学习先验知识，例如3D模型、照片、关键点或高阶的人脸识别特征等。
这些先验知识有助于缓解3D重建的解之间的歧义。
在这些方法的加持下，我们虽然已经能高效地获得较为准确的人脸3D模型，
但这些模型都牺牲了大多数环境以及人脸表面上的细节，无法再次渲染从而忠实地还原照片，
因而并不能直接应用于影视，游戏等工业领域中。
另外，部分监督信号需要较为复杂的额外步骤才能得到，且可能引入额外的误差，
例如人脸关键点检测中，部分关键点的位置不论在照片或是在3D模型上都难以准确定义。
可以预见，在数字孪生和元宇宙等概念走入公众视野的今天，
基于现实的形象批量生产高渲染质量的人脸模型将涌现新的需求，
高效3D人脸重建技术具有重要现实意义。

在人脸重建方法中，可微分渲染技术已占有一席之地。
该技术旨在准确估计3D渲染结果关于其渲染参数（模型、光照等）的梯度，
从而引入直接的合成分析(Analysis by Synthesis)方法，也即逆渲染方法。
如今从模型渲染图片的过程已十分复杂，且随着计算机图形学和神经渲染等技术的发展还在不断进化，对人脸则更是如此。
而逆渲染方法则直接将渲染结果和输入照片进行比较，根据渲染的误差来优化渲染参数，以此适应任意复杂的渲染方式。
可微分渲染则可以支持以简单的梯度下降法实现该优化过程。
该方法具有通用、准确、自动化等优点，可谓是3D模型与2D照片之间的桥梁。
得益于此，基于非受限环境照片的高效重建方法得以直接从大量无标注的人脸照片的数据集中学习人脸3D模型的先验知识。

然而，当前可微分渲染在人脸重建领域的应用还非常初步：
在渲染过程的梯度中，由于模型的不同部分之间相互遮挡而产生的可见性梯度通常最为显著，
这些梯度对模型与照片中的边缘的精确对齐至关重要。
但由于渲染采样过程的离散性，这些梯度往往难以估计。
在基于非受限环境照片的方法中，拍摄环境，相机参数，后处理流程等诸多不确定因素更提升了可见性梯度的估计难度。
现有人脸重建方法均仅考虑了着色部分的梯度，忽略了这些难以利用的可见性梯度，而是依赖更加成熟的多目立体（MVS）或人脸关键点检测等方法。
这导致了现有方法无法仅依赖可微分渲染来确定人脸的几何结构，而需要额外的步骤。
但额外步骤将增加重建流程的复杂性，且导致误差在多个环节中累积。

综上，高效3D人脸重建的应用广泛。但尚未能还原足够真实的细节，且对可微分渲染的应用仍有待进一步发展。
而本文的目标是在确保人脸重建精度的同时，降低重建流程整体的复杂性。
本文发现阻碍可见性梯度的应用最重要的因素是在非受限环境中难以建立的背景模型。
对此，本文提出了面积归一化的像素损失函数，以对可微分渲染的损失函数进行改进。
即使在未知背景的情况下，本文也希望能够仅通过像素损失函数，以可微分渲染的方式完成人脸重建。

\section{本文研究内容及贡献}

本文主要研究高效3D人脸重建方法的理论与应用。
本文从可微分渲染在3D人脸重建中应用时遇到的实际问题出发，
提出了改进的理论，并在实践中验证了其有效性。
本文的主要贡献可概括如下：

\begin{enumerate}
\item 针对可微分渲染在应用到3D人脸重建时，模型与背景交界处的可见性梯度难以被估计的问题，
本文从理论上分析了其原因是缺乏对背景的建模。
在缺乏对非受限环境中背景的先验知识的前提下，本文提出了面积归一化的像素损失，
以对可微分渲染的损失函数进行改进。
本文通过收缩、扩展两项梯度分析了其性质，
并提出了一种几乎无需额外计算和存储开销的方式实现这项改进。
本文通过实验证明了该项改进可以达成既定的目标：
在不对背景建模的情况下，使3D几何模型与照片中的物体边缘良好对齐。

\item 本文实现了一种通过单张在非受限环境中拍摄的照片，重建3D人脸模型的方案。
本文通过集成神经网络和3DMM人脸模型以提升鲁棒性；
通过可微分渲染技术实现更精准的对齐，
并在前述理论的基础上提出了一种基于SDF贴图的方法消除了人工裁剪的边缘带来的异常梯度；
还集成一些传统算法以在3D模型上重现照片中的更多细节。
该方案中的逆渲染优化过程仅使用了像素损失函数，
以非常简单的流程实现了精确的边缘对齐
取各家所长，该方案最终实现了细节丰富且全自动的，基于单张非受限环境照片的3D人脸模型重建。
其输出的3D人脸模型可支持在一定视角、光照和表情变化内较为逼真地重新渲染。

\end{enumerate}

\section{本文组织结构}

本文正文共分为4个章节，各章节的主要内容如下：

\newcommand*{\chapref}[1]{\hyperref[{#1}]{第\ref*{#1}章 \nameref*{#1}}}

\chapref{chap:intro}。
本章介绍了3D人脸重建、以及可微分渲染的背景、关联及其研究意义，
并总结了本文主要贡献及各章节的内容安排。

\chapref{chap:related_work}。
本章对课题相关的研究内容进行了综述，
其中包括非受限环境下的高效3D人脸重建、以及可微分渲染相关方向的研究和实践。
此外，还介绍了一些可用于3D人脸渲染的计算机图形学的基础知识。

\chapref{chap:method}。
本章介绍了本文提出的一种对现有可微分渲染的改进方法。
该方法能增强可微分渲染技术在难以建模背景的图像拟合任务中的适应能力。
其理论构建在修改的损失函数之上，并通过收缩、扩展两项梯度项来实现。
本章也通过实验验证了该方法的有效性。

\chapref{chap:recon}。
利用上一章提出的方法，本章介绍了一个从单张非受限环境照片重建3D人脸的实现。
该实现解决了人工裁剪的边缘处异常梯度的问题，
同时有机结合了神经网络、可微分渲染和一些传统算法，
达成了快速高效，细节丰富且全自动的3D人脸模型重建。
本章也与其他相关工作进行了比较。

\nameref{chap:conclusion}。
基于本文完成的工作结果对本文研究进行总结，并分析当前工作存在的不足和对未来工作的展望。
