\documentclass{scutmaster}

\usepackage{pgf}
\usepackage{import}
\usepackage{graphicx}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage{siunitx}
\usepackage{xcolor}
\usepackage{subcaption}
\usepackage{totcount}
\usepackage[author={胡玮文}]{pdfcomment}
\usepackage{tikz}
\usepackage{wrapfig}
\usetikzlibrary{backgrounds,intersections,calc,positioning,fit,shapes.geometric}
\usepackage{hyperref}

\regtotcounter{chapter}

\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}

\newcommand{\TODO}[1]{\textcolor{red}{TODO: #1}\GenericWarning{}{LaTeX Warning: TODO: #1}}

\title{基于可微分渲染的高效3D人脸重建\\方法研究}
\titleEN{Efficient 3D Face Reconstruction Based on Differentiable~Rendering}
\classificationnumber{TP37}

\author{胡玮文}
\authorEN{Weiwen Hu}
\studentnumber{202045611}
\phone{17701952145}
\email{sehuww@mail.scut.edu.cn}
\address{江西省南昌市青山湖区江大南路139号荣昌小区16栋（330029）}

\degree{工学硕士}
\major{软件工程}{数字人}

\supervisor{杜卿}{副教授}
\supervisorEN{Assoc. Prof.}{Qing Du}

\school{软件学院}

\begin{document}

\maketitle
\hideinblind{
    \maketitleEN
    \nominationpage
    \declareoforiginality
}

\frontmatter
\chapter{摘要}

高效3D人脸重建技术旨在从少量从不受约束环境拍摄的照片中恢复出人脸的3D模型，
这些模型已被广泛应用于人脸识别、人脸表情识别、人脸跟踪、人脸动画合成等任务中。
然而，这些模型还难以应用于需要直接渲染图像的游戏、影视等场景中，
具体来说，现有的重建方法还存在如下两个问题：
\begin{enumerate*}
\item 高质量的3D人脸模型获取成本高昂，由于缺少这样的训练数据，现有方法重建的模型未能包含准确的人脸细节，
如皱纹、毛孔等，
因此在重新渲染时还不能直接生成逼真的图像细节，无法达到工业应用的要求；
\item 现有方法未能充分利用照片中的边缘信息，它们依赖2D人脸关键点识别、多目立体等方法以重建人脸的几何形状，这会引入额外的复杂性和累积误差。
\end{enumerate*}

针对这些问题，本文提出了相应的解决方案：
\begin{enumerate}
\item 本文提出了一套多视角高精度人脸数据采集方案，
该方案尽量利用市面上可购买的部件，但也定制了一些专用的软硬件，
为3D重建所需的采集、标定、数据整理等环节提供了全面的支持，
力求实现高精度、高效率、且灵活可扩展的数据采集。
该方案为基于物理的高精度重建算法提供坚实基础，以期为高效重建算法提供高质量的3D训练数据支持。
\item 本文提出了一种基于可微分渲染的高效3D人脸重建算法，
在自然环境照片中背景难以建模的前提下，本文从理论上分析并解决了可见性梯度的计算问题，
提出并实现了一种面积归一化的像素损失函数，
使3D模型能更准确地对齐到照片中的边缘，从而提高了重建的准确性。
\item 在此之上，本文消除了在人脸模型上计算可见性梯度时，人工裁剪的模型边缘导致的异常梯度。
本文还结合其他方法实现了一个完整的人脸重建流程，
并展示和评估了其重建效果。
\end{enumerate}

\keyword{关键词} 可微分渲染；人脸重建；人脸扫描

\chapter{Abstract}

Efficient 3D face reconstruction aims to recover 3D models of faces from a small number of unconstrained photos,
which have been widely applied to face recognition, face expression recognition, face tracking, face animation synthesis, etc.
However, these models are still difficult to apply to scenes that require direct image rendering, such as games and movies.
Specifically, the existing reconstruction methods still have the following two problems:
\begin{enumerate*}
\item Due to the lack of high-quality 3D training data, the existing models cannot accurately capture the details of the face,
such as wrinkles and pores,
so they cannot directly generate realistic image details when re-rendering, which cannot meet the requirements of industrial applications.
\item The existing methods do not fully utilize the visibility gradient generated by differentiable rendering to supervise the geometry of the 3D model,
and the methods they depend on, such as 2D face landmark detection, multi-view stereo, etc., will introduce additional complexity and error.
\end{enumerate*}

To address these problems, this paper proposes the following solutions:
\begin{enumerate}
\item This paper proposes a multi-view high-precision face data collection scheme,
which tries to use the parts that can be purchased on the market,
but also uses some dedicated software and hardware.
This scheme supports all the requirments of 3D reconstruction, such as data collection, calibration, collation, etc.,
and strives for high-precision and high-efficiency, flexibliity and scalability.
This scheme provides a solid foundation for physically based high-precision reconstruction algorithms,
in order to provide high-quality 3D training data for efficient reconstruction algorithms.
\item This paper proposes an efficient 3D face reconstruction algorithm based on differentiable rendering.
Under the premise that the background is difficult to model in natural environment photos, this paper analyzes and solves the problem of computing visibility gradients from a theoretical point of view,
and proposes and implements an area normalized pixel loss function,
which aligns the 3D model more accurately to the edges in the photo,
On this basis, this paper also combines other methods to implement a complete face reconstruction pipeline,
and shows and evaluates the reconstruction results.
\end{enumerate}

\keyword{Keywords} Differentiable rendering; Face reconstruction; Face scanning

\tableofcontents

\listoffigures

\listoftables

\mainmatter
\include{intro}

\include{related_work}

\include{platform}

\include{method}

\include{recon}

\chapter{结论与展望}
\label{chap:conclusion}

本文研究了高效3D人脸重建的问题，
提出了一套多视角高精度人脸数据采集方案，
提出了一种基于可微分渲染的高效3D人脸重建算法。
在此之上，本文最终实现了一个完整的人脸重建流程，并取得了较为令人满意的效果。
本文的主要贡献可概括如下：
\begin{enumerate}
\item 本文详尽介绍了一套多视角高精度人脸数据采集方案，
全面覆盖了3D重建所需的菜系、标定、数据整理等步骤，
并对其各个软硬件部件的设计思路和实现效果进行了分析。
\item 本文提出并实现了一种适应未知背景的可微分逆渲染方法，
其中包括了一种面积归一化的像素损失函数，及其基于nvdiffrast的高效实现。
该方法充分利用可见性梯度，能有效将人脸模型对齐到照片中的边缘，并有应用到其他领域的潜力。
\item 本文实现了一个完整基于单张自然环境照片的人脸重建流程，
在上一点的基础上，本文结合其他算法，实现了鲁棒且自动的3D人脸重建，
并展示了其重建精度和重新渲染的效果。
\end{enumerate}

虽然在限定的范围内，本文取得了较为令人满意的重新渲染效果，
然而还需要看到，相比于业界的先进方案，本文所述的内容在3D人脸重建的应用领域内尚处于蹒跚学步的阶段，
还有大量的问题需要解决：
\begin{enumerate}
\item 本文所述的人脸数据采集方案使用了很多消费级的硬件，这虽然简化了设计，但也损失了很多灵活性。
例如，本文使用的微单相机在拍摄视频时不能保证严格的每帧同步，自动和手动对焦的切换无法自动化；
本文使用的灯具加柔光箱无法实现灯光在不同方向上的细粒度调节，也无法自动控制亮度。
\item 该采集方案需要配套的较为复杂的3D重建软件才能输出3D模型。
高质量的、基于物理的多视角3D人脸重建算法虽然已有较成熟的商业方案，但尚无可直接使用的开源软件。
因此，本文介绍的采集方案若要投入实际使用还需要进一步的开发工作。
可微分渲染技术在多视角重建中的应用也是一个值得进一步研究的问题。
\item 利用高质量的影视级人脸模型来补充高效重建算法的训练数据，从而改善其细节渲染效果，这依然是前沿的研究领域。
\item 本文所实现的基于单张自然环境照片的人脸重建流程仍是基于非常基础的渲染模型，
该模型并不能建模镜面反射，次表面散射等较为复杂的光线传播现象。
这导致本文重建的模型仅能在与照片中较为相似的环境光照和视角下重新渲染。
若要实现在影视中的大范围光照和视角变化，则需要有更多参数的更复杂的模型，也意味着需要更高质量的先验知识来重现一些微妙的效果。
\end{enumerate}

展望未来，为更好地建模人脸的先验知识，神经网络等人工智能技术将必不可少。
由于可微分渲染技术的发展应用，3D人脸重建和计算机图形学的关系也愈发密切。
然而计算机图形学独立于人工智能技术已经有了很长的历史，自身已经有了丰厚的技术积累，
笔者的硕士生涯太短，尚未能在这方面有足够的理解和实践。
未来这两个方向的研究者们或许应该加强交流合作，以进一步提升3D人脸模型的制作效率，降低成本。

\backmatter
\bibliography{main}

\hideinblind{
\chapter{致谢}

研究生三年的时光转瞬即逝。
这三年来，我虽有遗憾，但更多的是收获和成长，并度过了一段充实的学生生涯。
相比三年前，我在知识的深度和广度上均有提升，
我深知，这是在导师的指导和同学，以及其他一些人的帮助下才能实现的，我向他们表示感谢。
我首先要感谢我的导师杜卿老师，她温柔耐心、循循善诱，她也对本文的写作给予了很多的建议。
我还要感谢谭明奎教授，他在我的研究方向尚不明朗时为我提供了很多建议和帮助。
谭教授也为我们创造了舒适的实验室环境，并提供了高性能的机器学习计算资源。
特别要感谢CVTE和王乃洲博士，本文的大多数工作都是我在CVTE实习时完成的，
CVTE为本文的所有实验提供了经济支持。
感谢嘉立创公司提供的免费PCB打样服务，让我这个软件专业的学生也能有机会实现自己定制的硬件。
同时，我要感谢我的同学们，与他们相处我感到很快乐，他们也给予了我很多的帮助。
最后，感谢强盛的祖国，和平的时代，富饶的社会，以及无数为之而奋斗的先辈们，所有人的努力造就了今天令人安心的科研环境。
}

\end{document}
