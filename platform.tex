\chapter{多视角人脸数据采集平台}
\label{chap:platform}

在上一章的最后，本文提到了若要解决从单张图像同时重建人脸3D模型的几何和材质细节这一高度非适定的问题，则需要更多有关人脸的先验知识。
现有方法通常通过大量高精度的3D数据以训练神经网络模型来建模这种先验。
这些高精度的数据有时候以启发式的算法从2D图像中生成，
但更加鲁棒和贴近物理的方法自然是使用高精度的设备直接采集获得。

然而，可用于实现人脸几何和材质细节高精度重建的设备通常价格高昂，其采集的数据往往也由于商业价值较高而不被公开。
因此，不论是采集高精度的数据以重建高精度模型直接用于下游任务，还是用于建立先验以实现更高效的3D人脸重建，都离不开一套精准、高效、可靠的采集平台。

本章将介绍一套在较为有限的经济和时间成本下实现的多视角人脸数据采集平台。
该平台尽量使用可在市面上购买的部件，以减少对相关专业知识的需求。
同时配合一些定制的软件和硬件，实现对各个部件的高效统筹控制，为高精度重建所需的数据采集全流程提供支持。

\section{总体目标}

本文在设计和搭建该采集平台时，主要考虑了以下几个目标：
\begin{itemize}
\item 低硬件专业技能需求。本项目作为软件学院个人参与的项目，其所能得到的机械、结构、电子等方面的专业技术支持非常有限。
因此，为了能在有限的时间内完成该项目，本文尽可能地使用市面上可购买的部件，以减少对相关专业知识的需求。
虽然如此，本文还是使用了少量定制的硬件。

\item 高精度。高精度的数据是高精度3D重建的基础。
因此，对误差的控制贯穿与采集流程的各个环节，指导整个采集平台的软硬件设计。

\item 高效。整个平台在使用时，特别是在对被拍摄对象拍照时，应该尽可能地快速，以为大规模收集数据集提供可能。

\item 多任务。本平台作为一个主要用于研究性工作的采集平台，其需要具有一定的灵活性，以便应对研究中多变的需求。
基本地，该平台应能同时支持被动光源和主动光源的采集，能灵活配置相机和光源的位置和其他相关参数。

\end{itemize}

利用本平台采集的数据预计可用于多种3D人脸重建算法，例如本文其他部分介绍的基于可微分渲染的逆渲染方法。
同时也可用于如多目立体等传统的计算机视觉算法。

本章的主要贡献在于对该平台各个部分的设计和实现，以及对其性能的评估验证。
本章的剩余内容将具体介绍该平台的各个部分。

\section{整体结构设计}

铝型材支架设计

\section{被动相机同步}
\label{sec:passive_sync}

该装置无须独立供电。它能以很高的精度同时触发多台相机的对焦和快门，从而实现人脸多视角数据的捕获。

\paragraph{相机快门触发原理}

\paragraph{被动同步装置设计}

\paragraph{同步精度测试}

\input{calib}

\section{基于反射球的光源标定和HDRI合成}

\section{主动相机/闪光灯同步}

主动相机同步装置有单片机等实时控制系统控制，能独立控制每台相机、闪光灯触发延迟，最多24个通道。可用于快速抓拍不同闪光灯照明下的照片

\paragraph{主动同步装置硬件设计}

\paragraph{主动同步装置软件设计}

\paragraph{滚动快门原理}

\paragraph{闪光灯触发延迟快速标定方法}

\section{照片拍摄和整理流程}

\paragraph{同步装置连接与设定}

\paragraph{拍摄采集对象}

\paragraph{相机、光源标定数据采集}

\paragraph{照片拷贝和整理}

\section{初步验证}

作为该实验平台实用性的初步验证，本文利用该平台采集的数据使用传统的计算机视觉方法尝试重建人脸模型。

本文首先使用Colmap完成人脸的稀疏以及稠密点云重建。\TODO{参数调整}

然后，本文使用FlameFitting工具，将FLAME 3D模型配准到稠密点云上，得到初步的人脸几何形状。

然而，该配准的效果并不理想。因此本文使用Blender同时导入点云和几何形状，并手动调整模型顶点位置以完成更精确的配准。

最后，本文通过Unwrap方法，将照片映射到UV空间，每个视角获得一张纹理贴图，再将这些纹理贴图通过以下方式进行融合，最终获得一个带纹理的3D人脸模型。

\TODO{融合方式公式}

\TODO{结果图}

\section{后续工作}

然而，这种方法仅仅是对该平台采集的数据的初步利用，仅发挥了该平台的一小部分价值。
该平台的设计目标是用于运行可微分渲染算法，后续的研究者们将能利用该平台开展诸多基于可微分渲染的研究，例如：
\begin{itemize}
\item 在传统计算机视觉重建的几何形状的基础上，利用可微分渲染算法，实现符合基于物理的渲染(PBR)流程的人脸材质，包括粗糙度、次表面散射等参数。
\item 利用所采集到的HDRI光源信息，基于分离求和近似(split sum approximation)的可微分光栅化渲染算法，直接端到端地同时估计人脸的几何结构和材质。
\item 利用光线追踪方法，进一步考虑全局光照，以估计更加准确的材质。
\item 将本系统所使用的消费级微单相机更换为工业相机，以实现视频帧同步，可将该实验平台扩展为采集人脸动态表情数据。
\end{itemize}
